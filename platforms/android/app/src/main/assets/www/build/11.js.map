{"version":3,"sources":["../../src/pages/add-card-modal/add-card-modal.module.ts","../../src/pages/add-card-modal/add-card-modal.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AddCardModalPage } from './add-card-modal';\n\n@NgModule({\n  declarations: [\n    AddCardModalPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(AddCardModalPage),\n  ],\n})\nexport class AddCardModalPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-card-modal/add-card-modal.module.ts","import { Component } from \"@angular/core\";\nimport {\n  IonicPage,\n  NavController,\n  NavParams,\n  ViewController,\n  ToastController\n} from \"ionic-angular\";\nimport { AngularFireDatabase } from \"angularfire2/database/\";\nimport { AngularFireAuth } from \"angularfire2/auth/\";\nimport { AES256 } from \"@ionic-native/aes-256\";\n\n@IonicPage()\n@Component({\n  selector: \"page-add-card-modal\",\n  templateUrl: \"add-card-modal.html\"\n})\nexport class AddCardModalPage {\n  private secureKey: string;\n  private secureIV: string;\n  cardNo: any;\n  expiry: any;\n  Cvc: any;\n  sortcode: any;\n  accountNumber: any;\n  holderName: any;\n  stringForCrypto: string;\n  stringForDecryption: string;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private vCtrl: ViewController,\n    private afDatabase: AngularFireDatabase,\n    private afAuth: AngularFireAuth,\n    private toast: ToastController,\n    private aes: AES256\n  ) {\n    this.generateSecureKeyAndIV();\n  }\n\n  close() {\n    this.vCtrl.dismiss();\n  }\n\n  async addDetails() {\n    var formatExpiry =\n      this.expiry.toString().substr(0, 2) +\n      \"/\" +\n      this.expiry.toString().substr(2);\n    var formatSortCode =\n      this.sortcode.toString().substr(0, 2) +\n      \"-\" +\n      this.sortcode.toString().substr(2, 2) +\n      \"-\" +\n      this.sortcode.toString().substr(4, 2);\n\n    var formatCardNo =\n      this.cardNo.toString().substr(0, 4) +\n      \"-\" +\n      this.cardNo.toString().substr(4, 4) +\n      \"-\" +\n      this.cardNo.toString().substr(8, 4) +\n      \"-\" +\n      this.cardNo.toString().substr(12, 4);\n    console.log(formatSortCode, formatExpiry);\n    this.sortcode = formatSortCode;\n    this.expiry = formatExpiry;\n    this.cardNo = formatCardNo;\n    var key = this.afAuth.auth.currentUser.uid;\n    if (this.holderName == \" \" && this.cardNo == \" \") {\n      this.toast\n        .create({\n          message: \"One or more fields are empty\",\n          duration: 2000,\n          position: \"middle\"\n        })\n        .present();\n    } else if (\n      this.holderName == undefined ||\n      this.holderName == \" \" ||\n      this.holderName == null\n    ) {\n      this.toast\n        .create({\n          message: \"Cardholder cannot be empty.\",\n          duration: 2000,\n          position: \"middle\"\n        })\n        .present();\n    } else if (formatCardNo.length != 19) {\n      this.toast\n        .create({\n          message: \"Card number Must be 16 digits.\",\n          duration: 2000,\n          position: \"middle\"\n        })\n        .present();\n    } else if (this.sortcode.length != 8) {\n      this.toast\n        .create({\n          message: \"Sortcode Must be 6 digits.\",\n          duration: 2000,\n          position: \"middle\"\n        })\n        .present();\n    } else if (this.accountNumber.length != 8) {\n      this.toast\n        .create({\n          message: \"Account number Must be 8 digits.\",\n          duration: 2000,\n          position: \"middle\"\n        })\n        .present();\n    } else if (this.Cvc.length != 3) {\n      this.toast\n        .create({\n          message: \"CVC must be 3 digits\",\n          duration: 2000,\n          position: \"middle\"\n        })\n        .present();\n    } else if (this.expiry.length != 5) {\n      this.toast\n        .create({\n          message: \"Must be MM/YY\",\n          duration: 2000,\n          position: \"middle\"\n        })\n        .present();\n    } else {\n      var eText1: string;\n      var eText2: string;\n      var eText3: string;\n      var eText4: string;\n      var eText5: string;\n      var eText6: string;\n      console.log(this.secureKey, this.secureIV);\n      await this.aes\n        .encrypt(this.secureKey, this.secureIV, this.cardNo)\n        .then(promise => (eText1 = promise.valueOf()))\n        .catch((error: any) => console.error(error));\n      await this.aes\n        .encrypt(this.secureKey, this.secureIV, this.accountNumber)\n        .then(promise => (eText2 = promise.valueOf()));\n      await this.aes\n        .encrypt(this.secureKey, this.secureIV, this.holderName)\n        .then(promise => (eText4 = promise.valueOf()));\n      await this.aes\n        .encrypt(this.secureKey, this.secureIV, this.Cvc)\n        .then(promise => (eText5 = promise.valueOf()));\n      await this.aes\n        .encrypt(this.secureKey, this.secureIV, this.expiry)\n        .then(promise => (eText6 = promise.valueOf()))\n        .catch((error: any) => console.error(error));\n      await this.aes\n        .encrypt(this.secureKey, this.secureIV, this.sortcode)\n        .then(promise => (eText3 = promise.valueOf()))\n        .catch((error: any) => console.error(error));\n      var payment = [\n        {\n          Holder: eText4,\n          Card: eText1,\n          Expiry: eText6,\n          CVC: eText5,\n          Sort: eText3,\n          AccountNo: eText2,\n          Key: this.secureKey,\n          IV: this.secureIV\n        }\n      ];\n      console.log(payment);\n      this.afDatabase.list(`user/${key}`).push(payment[0]);\n      this.close();\n    }\n  }\n\n  async generateSecureKeyAndIV() {\n    this.secureKey = await this.aes.generateSecureKey(\"pook\"); // Returns a 32 bytes string\n    this.secureIV = await this.aes.generateSecureIV(\"pook\"); // Returns a 16 bytes string\n  }\n\n  ionViewDidLoad() {\n    console.log(\"ionViewDidLoad AddCardModalPage\");\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-card-modal/add-card-modal.ts"],"sourceRoot":""}
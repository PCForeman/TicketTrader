{"version":3,"sources":["../../src/pages/account/account.module.ts","../../src/pages/account/account.ts"],"names":[],"mappings":"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","file":"13.js","sourcesContent":["import { NgModule } from \"@angular/core\";\nimport { IonicPageModule } from \"ionic-angular\";\nimport { AccountPage } from \"./account\";\n\n@NgModule({\n  declarations: [AccountPage],\n  imports: [IonicPageModule.forChild(AccountPage)]\n})\nexport class AccountPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/account/account.module.ts","import { Component } from \"@angular/core\";\nimport {\n  IonicPage,\n  NavController,\n  NavParams,\n  App,\n  ToastController,\n  ModalController,\n  ModalOptions,\n  AlertController\n} from \"ionic-angular\";\nimport { AngularFireDatabase, AngularFireObject } from \"angularfire2/database\";\nimport { AngularFireAuth } from \"angularfire2/auth\";\nimport { Observable } from \"rxjs\";\nimport { LoginPage } from \"../login/login\";\n\n@IonicPage()\n@Component({\n  selector: \"page-account\",\n  templateUrl: \"account.html\"\n})\nexport class AccountPage {\n  currentPassword: any;\n  comparePassword: any;\n  newPassword: any;\n  playerPassword: AngularFireObject<any>;\n  userData: Observable<any>;\n  gPassword: any;\n\n  constructor(\n    private afDatabase: AngularFireDatabase,\n    private afAuth: AngularFireAuth,\n    private toast: ToastController,\n    private app: App,\n    private modal: ModalController,\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    private aCtrl: AlertController\n  ) {}\n\n  ionViewDidLoad() {\n    this.displayAccountData();\n  }\n\n  openModal(){\n\n    var currentUser = this.afAuth.auth.currentUser.uid;\n    var ref = this.afDatabase.object(`user/${currentUser}`);\n    ref.snapshotChanges().subscribe(snapshot => {\n    const ad1 =  snapshot.payload.child(`addressL1/`).val().toString();\n    const ad2 = snapshot.payload.child(`addressPC/`).val().toString();\n    const dob =  snapshot.payload.child(`dOb/`).val().toString();\n    const em =  snapshot.payload.child(`email/`).val().toString();\n    const fn =  snapshot.payload.child(`firstname/`).val().toString();\n    const pw =  snapshot.payload.child(`password/`).val().toString();\n    const pn =  snapshot.payload.child(`phoneNo/`).val().toString();\n    const sn =  snapshot.payload.child(`surname/`).val().toString();\n    const myModalOpts: ModalOptions = {\n      cssClass: \"modal\",\n      enableBackdropDismiss: true,\n      showBackdrop: true\n    };\n    const accountData = {\n      adress1: ad1,\n      adress2: ad2,\n      dOb: dob,\n      email: em,\n      password: pw,\n      firstname: fn,\n      phonenumber: pn,\n      surname: sn \n    };\n    \n    const myModal = this.modal.create(\n      \"ModalAccountPage\",\n      { data: accountData },\n      myModalOpts\n    );\n    myModal.present();\n  })\n}\n\naddCard(){\n  const myModalOpts: ModalOptions = {\n    cssClass: \"modal\",\n    enableBackdropDismiss: true,\n    showBackdrop: true\n  };\n  const listingRef = {\n  };\n  \n  const myModal = this.modal.create(\n    \"AddCardModalPage\",\n    { ticket: listingRef },\n    myModalOpts\n  );\n  myModal.present();\n}\n\nasync deleteAccount(){\n  var ref = this.afDatabase.object(`user/${this.afAuth.auth.currentUser.uid}`);\n  ref.snapshotChanges().subscribe(snapshot => {\n  const pw =  snapshot.payload.child(`password/`).val().toString();\n  console.log(pw);\n  let alert = this.aCtrl.create({\n    title: 'Enter password to delete account',\n    inputs: [\n      {\n        name: 'password',\n        placeholder: 'Password',\n        type: 'password'\n      }\n    ],\n    buttons: [\n      {\n        text: 'Cancel',\n        role: 'cancel',\n        handler: cancelled => {\n          console.log('Cancel clicked');\n        }\n      },\n      {\n        text: 'Login',\n        handler: data => {\n          console.log(data)\n          if (data.password == pw) {\n          try {\n          var tempKey = this.afAuth.auth.currentUser.uid\n          console.log(tempKey)\n          this.logout()\n           this.app.getRootNav().setRoot(LoginPage);\n           this.afDatabase.object(`user/${tempKey}`).remove();\n          }\n           catch (e) {\n            console.log(e);\n           }\n          } else {\n            console.log('Cancelled')\n            return false;\n          }\n        }\n      }\n    ]\n  });\n  alert.present();\n})\n}\n\n  getUserPassword() {\n    this.playerPassword = this.afDatabase.object(\n      `user/${this.afAuth.auth.currentUser.uid}`\n    );\n    this.playerPassword.snapshotChanges().subscribe(snapshot => {\n      var password = snapshot.payload.child(`password/`).val();\n      this.gPassword = password;\n    });\n  }\n\n  updateUserPassword() {\n    var key = this.afAuth.auth.currentUser.uid;\n    this.getUserPassword();\n    if (\n      this.currentPassword == this.gPassword &&\n      this.newPassword == this.comparePassword\n    ) {\n      this.afAuth.auth.currentUser.updatePassword(this.newPassword);\n      this.afDatabase\n        .object(`/user/${key}`)\n        .update({ password: this.newPassword });\n      this.passwordChangedMessage();\n      this.currentPassword = \"\";\n      this.newPassword = \"\";\n      this.comparePassword = \"\";\n    }\n  }\n\n  checkOut() {\n    this.navCtrl.push(\"BuyPage\");\n  }\n\n  orderHistory() {\n    this.navCtrl.push(\"OrderHistoryPage\");\n  }\n\n  passwordValidationMessage() {\n    this.toast\n      .create({\n        message: \"Please ensure all fields are filled out\",\n        position: \"middle\",\n        duration: 2000\n      })\n      .present();\n  }\n\n  passwordChangedMessage() {\n    this.toast\n      .create({\n        message: \"Password successfully changed\",\n        position: \"middle\",\n        duration: 2000\n      })\n      .present();\n  }\n\n  displayAccountData() {\n    this.afAuth.authState.take(1).subscribe(data => {\n      if (data && data.email && data.uid) {\n        this.userData = this.afDatabase\n          .object(`user/${data.uid}`)\n          .valueChanges();\n      } else {\n        this.toast\n          .create({\n            message: `Could not find authentication details`,\n            position: \"middle\",\n            duration: 3000\n          })\n          .present();\n      }\n    });\n  }\n\n  logout() {\n    this.afAuth.auth.signOut().then(() => {\n      this.toast\n        .create({\n          message: \"Signed out\",\n          position: \"middle\",\n          duration: 3500\n        })\n        .present();\n      this.app.getRootNav().setRoot('LoginPage');\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/account/account.ts"],"sourceRoot":""}
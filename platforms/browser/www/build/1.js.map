{"version":3,"sources":["../../src/pages/sell/sell.module.ts","../../src/pages/sell/sell.ts"],"names":[],"mappings":"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","file":"1.js","sourcesContent":["import { NgModule } from \"@angular/core\";\nimport { IonicPageModule } from \"ionic-angular\";\nimport { SellPage } from \"./sell\";\n\n@NgModule({\n  declarations: [SellPage],\n  imports: [IonicPageModule.forChild(SellPage)]\n})\nexport class SellPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/sell/sell.module.ts","import { Component } from \"@angular/core\";\nimport {\n  IonicPage,\n  NavController,\n  NavParams,\n  ToastController,\n  App,\n  LoadingController\n} from \"ionic-angular\";\nimport { Listings } from \"../../models/listing\";\nimport { AngularFireAuth } from \"angularfire2/auth\";\nimport { AngularFireDatabase } from \"angularfire2/database\";\nimport { AngularFireStorage } from \"angularfire2/storage\";\nimport { HomePage } from \"../home/home\";\nimport { Chooser } from '@ionic-native/chooser/index';\nvar gListingCreationTime;\nvar gListingCustomerPayout;\nvar gListingServiceCharge;\n\n@IonicPage()\n@Component({\n  selector: \"page-sell\",\n  templateUrl: \"sell.html\"\n})\nexport class SellPage {\n  firebaseService: any;\n  toastCtrl: any;\n  ionViewDidLoad() {\n    console.log(\"ionViewDidLoad SellPage\");\n    this.listingTimestamp();\n    this.lockTicketButton();\n    this.unlockTicketButton();\n    this.lockFileUpload();\n    this.unlockFileUpload();\n  }\n\n  listing = {} as Listings;\n\n  constructor(\n    private afAuth: AngularFireAuth,\n    private toast: ToastController,\n    private app: App,\n    private chooser: Chooser,\n    private afStorage: AngularFireStorage,\n    private fbDatabase: AngularFireDatabase,\n    private ldCtrl: LoadingController,\n    public navCtrl: NavController,\n    public navParams: NavParams\n  ) {}\n\n  async chooseFile(){\n  var res =  await this.chooser.getFile('image')\n    .then(file => console.log(file ? file.name : 'canceled'))\n    .catch((error: any) => console.error(error));\n    console.log(res);\n  }\n\n  checkOut() {\n    this.navCtrl.push(\"BuyPage\");\n  }\n\n  storageRef() {}\n\n  orderHistory() {\n    this.navCtrl.push(\"OrderHistoryPage\");\n  }\n\n  generateListingId() {\n    var bit1 = Date.now();\n    var bit2 = Math.floor(Math.random() * 99 + 1);\n    var randomID = (bit1 + bit2).toString();\n  }\n\n  listingTimestamp() {\n    var Y = new Date().getFullYear().toString();\n    var M = new Date().getMonth().toString();\n    var D = new Date().getDay().toString();\n    var H = new Date().getHours().toString();\n    var MM = new Date().getMinutes().toString();\n    var recordListingTime =\n      D + \"/\" + M + \"/\" + Y + \" \" + \"At\" + \" \" + H + \":\" + MM;\n    gListingCreationTime = recordListingTime;\n  }\n\n  ticketIncomeCalc() {\n    var userMoney = this.listing.listingPrice;\n    var ticketTraderMoney = Number(((userMoney / 100) * 7 + 0.3).toFixed(2));\n    console.log(ticketTraderMoney);\n    var userFinal = Number(userMoney - ticketTraderMoney).toFixed(2);\n    console.log(userFinal);\n    if (userMoney >= 0 && userMoney <= 1000) {\n      gListingCustomerPayout = userFinal;\n      gListingServiceCharge = ticketTraderMoney;\n      this.toast\n        .create({\n          message:\n            \"You will recieve Â£\" +\n            userFinal +\n            \", when your ticket has been bought.\",\n          position: \"middle\",\n          duration: 3500\n        })\n        .present();\n    } else {\n      this.toast\n        .create({\n          message: \"Value not numerical, or exceeds the price limit.\",\n          position: \"middle\",\n          duration: 3500\n        })\n        .present();\n    }\n  }\n\n  logout() {\n    this.afAuth.auth.signOut().then(() => {\n      this.toast\n        .create({\n          message: \"Signed out\",\n          position: \"middle\",\n          duration: 3500\n        })\n        .present();\n      this.app.getRootNav().setRoot(\"LoginPage\");\n    });\n  }\n\n  lockFileUpload() {\n    var disableFileUpload = <HTMLButtonElement>(\n      document.getElementById(\"btnUploadTicket\")\n    );\n    disableFileUpload.disabled = true;\n  }\n\n  unlockFileUpload() {\n    document\n      .getElementById(\"btnCheckPrice\")\n      .addEventListener(\"click\", function() {\n        var EnableFileUpload = <HTMLButtonElement>(\n          document.getElementById(\"btnUploadTicket\")\n        );\n        EnableFileUpload.disabled = false;\n      });\n  }\n\n  lockTicketButton() {\n    var disableCreateListing = <HTMLButtonElement>(\n      document.getElementById(\"btnCreateListing\")\n    );\n    disableCreateListing.disabled = true;\n  }\n\n  unlockTicketButton() {\n    document\n      .getElementById(\"btnUploadTicket\")\n      .addEventListener(\"click\", function() {\n        var EnableCreateListing = <HTMLButtonElement>(\n          document.getElementById(\"btnCreateListing\")\n        );\n        EnableCreateListing.disabled = false;\n      });\n  }\n\n  showSpinner() {\n    let loading = this.ldCtrl.create({\n      content: \"\"\n    });\n    loading.present();\n    setTimeout(() => {\n      loading.dismiss();\n    }, 1000);\n  }\n\n  async createListing() {\n    await this.showSpinner();\n    var artist = this.listing.listingName;\n    var location = this.listing.listingLocation;\n    var startTime = this.listing.listingTime;\n    var date = this.listing.listingDate.toString();\n    var p3 = date.slice(0, 4);\n    var p2 = date.slice(5, 7);\n    var p1 = date.slice(8, 11);\n    var rDate = p1 + \"/\" + p2 + \"/\" + p3;\n    console.log(rDate);\n    var price = this.listing.listingPrice;\n    if (\n      artist == \"\" ||\n      location == \"\" ||\n      (startTime < 0 && startTime > 24) ||\n      date == null ||\n      price == NaN ||\n      price < 0 ||\n      price > 1000\n    ) {\n      this.toast\n        .create({\n          message: \"One or more fields are incorrect, please check them\",\n          duration: 3000,\n          position: \"bottom\"\n        })\n        .present();\n    } else {\n      this.generateListingId();\n      await this.afAuth.authState.take(1).subscribe(auth => {\n        this.listing.listingDate = rDate;\n        this.listing.listingSellerUID = auth.uid;\n        this.listing.listingCreationDate = gListingCreationTime;\n        this.listing.listingServiceCharge = gListingServiceCharge;\n        this.listing.listingCustomerPayout = gListingCustomerPayout;\n        this.listing.listingSold = false;\n        var ref = this.fbDatabase\n          .list(`unaprovedTickets/`)\n          .push(this.listing)\n          .orderByKey();\n        console.log(ref);\n        this.toast\n          .create({\n            message: \"Listing successfully created.\",\n            position: \"middle\",\n            duration: 2000\n          })\n          .present();\n        this.navCtrl.setRoot(HomePage);\n      });\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/sell/sell.ts"],"sourceRoot":""}